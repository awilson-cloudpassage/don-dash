sudo: required
services:
- docker
before_install:
- docker build -t $DOCKER_IMAGE .
after_success:
- docker login -e $DOCKER_EMAIL -u $DOCKER_USER -p $DOCKER_PASSWORD
- docker push $DOCKER_IMAGE
script:
- docker run -it --rm $DOCKER_IMAGE py.test
- docker run -it --rm -e HALO_API_KEY=$HALO_API_KEY -e HALO_API_SECRET_KEY=$HALO_API_SECRET_KEY -e HALO_API_HOSTNAME=$HALO_API_HOSTNAME -e HALO_API_PORT=$HALO_API_PORT -e HALO_AGENT_KEY=$HALO_AGENT_KEY -e SERVER_GROUP=$SERVER_GROUP $DOCKER_IMAGE /app/scan_with_halo.sh
env:
  global:
  - SERVER_GROUP=demo_group
  - HALO_API_HOSTNAME=api.cloudpassage.com
  - HALO_API_PORT=443
  - DOCKER_IMAGE="awilson/don-dash:latest"
  - secure: eErB50JNOAPE/7HVAWGzcFbCIQMvxZiqVFg+pa3CgrxW8n4wa3I9TIJVUwuE8LM4Xe2e0/CrKGeDu+8u3v7EBGv2GOD2Z/rOUfhIC2L61PagWU2IxqPqM3Uv/PR2fDJ9utkzXp+1JWMC8/p99ZFvShc0Kplr3r+d8NCJwl3siVzGFEolWNFsQ7FZqsyz8wJKVK5d/aoV/OaarJoEFh7FS5tay1qtOqs1Oo7ADLIxKRPH7WNk3UNNYDDj1joFbmPFUa254oF0ssMnGvEVYS6Kt1o65XCs8820QJjkHiSrWPzStWR+VUHeWMegaTiG1IMN4YuptU+1Gy4OHhTAM8erNhsQ7QGOpM2o+EVjZCleHAtzpdGnGqCaAdPTqJNizGxGVtaFx0UJfEoJuIBZ6eVmQhlrs+RutP+ANQADJANr02Vj91KwE3Uj25wfnSabELfxGQ2Utzs5wztyv2PGKGmvEUD5TBVBe9q0tL/CDu6r+/EZMX3MQbGhkjoRe8v37UxV0IcQAM1Ail4jGONILUV3cjQ2DphrPoLWoX0CuNCqI6ndjNgeRfdlcjgRVzHJqJHjwnahjLTMBcKEXTUYcnQMZUGgC+qQ650OC+O+aBLQaY1h6gKT67ZL+CmFF3WHYpBpIg44QPrqrv+ryG6B2vhaeWg1puQZm7+w4tKIIXebaJU=
  - secure: bdHgX1YCTLAW+i/CGIM5jg9USJIYQKTm7wvbPW1KgxjkqWowDtB+8WV9OwQAI4APYsMVSrGa4rp/NAq4TsWtdcnOcIjMIgJLJ7d8BEwZXjBuoeW56QGU7A2OlAqVDCVBCzVPg5qks0oP9VT/QymJ4blW7bw8hoCvpLUEzETymNRQqBCrkJozurP/Yc0Fw+mAUQE1Wta0f10S505CsLcaZhqAJvybmSe+arakGfBqYHedmHQt8UEcjozptGzuuTdFo+HSGZRvMXCKOM+eQyy5qobw5+v9A8czcFWM9KdeTC/nYI/VsjJCRb3lbG2TGn7qJ4vV3Gzhf/Cl6ZCVOgZjQRtGktpM04vy0ySwJ9DQMOiKpG63MciMar4Q7hVkOa1BbSBs5y2YAUGimZnf9pHJXA3Z4ZFIQruyIhv6SpqIVyrm5Oumj6ro8RGlE7UStelI1TkwJjdORYFBQvC9wckB5TPQkuCDKtRwcnkcbcCn+PXk+lhw6dw7WN4HuTu9RmLJ1E9CC7gOOdZuoSH+PnZuJKH//uan4kesvtRDM95SBZ3PeNC/D6LmQUzye6kOjrMudt+8FuFj20taz+8Fz8nUfEW/KkxflJ1H1pyusWt2xJ+7VqnWDBmB3SkGOVc2b24w628+lOABpNQPAhRtsIjj0dNTaGJEja93LHGAye29GCI=
  - secure: av0JaU1Vuz+FiwW/T5imFzF4cRGpssEI5UVag7I/+zG3lGjrVUqQdDS9lbVpvpbsEH+VdGFE6BN9C31zBxlcMDiW68GZTIazgKm2Nvcfc1LzfnZR5J4aEOFF4EhD70VOif1kWDlNWpB2FvCrz6mLiO/jviIrMotx4HHsIA3IzOO3YHri+IiuxowsWwBEl0iPplMR4ihgmQ5O/wmsqssORdNgrMciV8rdPfTHLoRd2xg9Y1Nig9vohemQGfdpP9ABUL1jUQ8i3eLzZi948JDMH9IZTBlad5j5FKP6hSynlzAhcTrx9BBZ78+a/t/Op9aqX/0oqKI1cO1hBsd8vOF2ncg5gn1+iBlIlXHV8DR70eRxEODJqfWtSaFxraoi14xKPZAwDi528xQA2pfGTXcQpiDbJ6Tlo/z+1ahGxUmCVQMC/V+fFb88rtRzg/OCuQdUrDs0PSzrzkasacLO0nuNEu19PKg70Pr5f2VJS7Mkn/gMVUYyPIw4bYy7fa6CLt85+XZ68jy/PwVo64YQfGbfX29w+AdNdDQ+NL/5VN40aIBIMyXVZ9V5Dg8+5MInQAPZuc+MUZZpghhB1F6dFgUVV6tjSHG/4LLP0iiYsuWAkg5FcjeEkI2AYeSgwYiXihMsMhroxVKxYaUsmFn66if9vrJhmUKwadwhMhhuZCHIwb0=
  - secure: G9BisFMkEeHJ9V9/1JQaXbeMlAVTB/dL7nxq4iFRPCgRHOOsJQn1sld4yrBSASIRKldJiN2aLU91rZjvScrozIXr3ukBINJeakqiydXc6Kp8z/HNOfRMvaUkJ+lBeI7Qb56rHOVlnjbY4IW9REnBWULEmr3cL7V8oTYP08+T7o/SV7/7d87pb+P7CEk86tKBkyBBghXkfbb5lfBqieUICCkUmfM40Y6sofn3Isw1+HV4G+xqghsLE91fQoxg0JeCSdw2FYo5fZMt5p2S88QVQZ0Ck//3C3v5BFX3NyobKQ5ggVGsIMjN0np8h51ceb3JujnyLqKNtc2KpVAaMSYEHd/FQKMIiUhpLswl3UrzvQ7ZJUvYWDpoYV2Hnu1JipPVg4mtSXWET7/JL7rngQ1qGOqiVTi4a9MtNqe/SfT4IhI+T9/kAvbOYkpTQj//tuKy50U1WlYPpRPu6VNhppDqYvdVLkLb9+uGr9yxih2TIKy1fgNq4ocTYQ7dVaW1Akr8eVSWkVdOa/dKqFperbpKH8yv9QyMbMph8NKioQmstU+H3tNUq8VldoKRssnVSmy2uRVfNFRYnaXEIxir3h6GSE/LtwwJUHBTn8t99TZwUtKuzHflsei6KAgUw+wO0YpPgKAuueCf0I2c1A/xYcV/rW2PK0t2PLNPsGS+c1xK1Uc=
  - secure: XfXVPGGE0Qv/BT+s1TlHBdk2ZPtHeci5ful7NkWLizMpnVg2op53Ihsnu5hXMSdsBYvQVOrlvvLHvAcn1+5PpYUkzi8vE+UDYWBGpRtfbtTD0UAZaWHiRWlh/EYSblwgQdWNfs28znALtCQCfV8iyrBjc0ZY/fZGyTp2seKDrFzP96xOSt4Y4jrp/AJ1lWrwvZheRCGoLxTVAUiqpnqupr6hfRxLWkRGYXQ1WRjYhSi2kxHinrrayNWr3Vk2Ve7ab0wBIgDhs6yRTWnXq89lS1HIMsooacaZE+O5AKa4FYngsohzuhaHECdiP7XP80omzLyHNqxX3Xj9kzluR3iLpqmznKHyDWMgEhqOlFWZnd+whP5gDVYwzsLFAVprm8PwIpRQm8/otycD9qk63porzcoJtF6UkKNdLE2N2aYUCOGcCfoDuSU6ZxroX/ctZdHYXZIE9OWGsOw1L3D69AHhHukEpC0Uu9lkFvuGXuuuMt81n8aXSCRgNYpiVhetauimu3ayt+oqgfxRREHzAh4LfCyVqA3RbtOBXVcRERPvcOSlIRC8kjIwiyjodLsLzd6LRIsRevS4qKQbKA81kO/MJPh2tHF8IWocXEGAJXe7RnHX/5+ILxH6Xj+KEQQNwhTZOIPM36HRC40mUPljhECT12MHNYDmDD2Qvxtu93M+mPk=
  - secure: PeOMhbE4DNV2uAUoFDMl6DcPq1vQJTaDEQ5leZGo9RSAJ2hnZEuo9q3equenDgbuB3qyo+CamWV1m/nQf23qHMk+S8ZDK9w/8x/M/1xfUI+ns55aBt25deEYwXNF1fT+xGpSHZQTb8bhjZ5vRCOOJ6INjxoJHGsHAT0azRnKs85MY6DUF1K+RDw1lGsK80H7+506bP0TVE64Xns4rRJ6fyhT67Qh9BgGfT/ZvuzgAIu68WPJY3X6qbOOXNbETAZfgS4f4GiTA2cKSiMcccef1NW62ix9hBtuEVu/ytgMSMc8EDAhBtRWBGRCqElThvJ6PNU1/m1c0zvRU+X/Af0CKIY8v9KMf9ebNeUoMokW4OxMoie7yqVTnf56i5wC4fJYVFhb/Vs3UnDKZUguS65MQN9X8TVI3LaQfNyD5efBKKRZLq+c9iAexRR8P4VB7XdDzdDPCImYfXn3Ru6vLPLHntRwUp9V0RuTje5uC7zygdkkJYUd8mrSO0wylQf2C8C4KEJnlTgf299ND43hdzZu5HzlOxFkI997vRY+rrM922E5NzbUs5Jv4kWA86e6baARTblUprHPr+QVwRqAGpR+lhPVBddewD6RO3SoIb6iY3fOq+93fJ+Ejs9aeWSwktn7264DRsHoWpWbHBijYLcMvdPLpkhWuJjdGMJLTJf5Jak=
